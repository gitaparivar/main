<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Bhagavad Gita</title>
  <meta content="" name="description">
  <meta content="" name="Bhagvad Gita Geeta भगवद् गीता ">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
   <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script> -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.1.1/jspdf.umd.min.js"></script>
	 <!-- <script src="assets/js/Maukta-Regular-normal.js"></script> 
	<script src="assets/js/MANGAL-normal.js"></script>-->
	<script src="assets/js/aparaj-normal.js"></script> 
	
	<script src="https://unpkg.com/docx@5.0.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>

	<link href="/assets/fontawesome-5.15.1/css/all.css" rel="stylesheet"> <!--load all styles -->
	<script src="assets/js/loglevel.min.js"></script>

	<!-- =======================================================
  * Template Name: Arsha - v2.2.1
  * Template URL: https://bootstrapmade.com/arsha-free-bootstrap-html-template-corporate/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  
  
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top header-inner-pages">
    <div class="container d-flex align-items-center">

      <h1 class="logo mr-auto"><a href="index.html">Gita Parivar</a></h1>
      <!-- Uncomment below if you prefer to use an image logo -->
      <!-- <a href="index.html" class="logo mr-auto"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

      <nav class="nav-menu d-none d-lg-block">
        <ul>
          <li><a href="index.html">Home</a></li>
          <!-- <li><a href="#about">About</a></li>
          <li><a href="#services">Services</a></li> -->
          <li class="active"><a href="#">Gita</a></li>
          <!-- <li><a href="#team">Team</a></li>
           <li class="drop-down"><a href="">Drop Down</a>
            <ul>
              <li><a href="#">Drop Down 1</a></li>
              <li class="drop-down"><a href="#">Deep Drop Down</a>
                <ul>
                  <li><a href="#">Deep Drop Down 1</a></li>
                  <li><a href="#">Deep Drop Down 2</a></li>
                  <li><a href="#">Deep Drop Down 3</a></li>
                  <li><a href="#">Deep Drop Down 4</a></li>
                  <li><a href="#">Deep Drop Down 5</a></li>
                </ul>
              </li>
              <li><a href="#">Drop Down 2</a></li>
              <li><a href="#">Drop Down 3</a></li>
              <li><a href="#">Drop Down 4</a></li>
            </ul>
          </li> 
          <li><a href="#contact">Contact</a></li> -->

        </ul>
      </nav><!-- .nav-menu -->

      <!-- <a href="#about" class="get-started-btn scrollto">Get Started</a> -->

    </div>
  </header><!-- End Header -->

  <main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <section id="breadcrumbs" class="breadcrumbs">
      <div class="container">

        <ol>
          <li><a href="index.html">Home</a></li>
          <li>Gita</li>
        </ol>
        <h2>Chapter List</h2>
		<div class="row">
		<div class="col-lg-9 col-md-12 col-sm-12  d-flex">
		<ol>
          <li><a class="chSelect" id="1" href="#">1</a></li>
          <li><a class="chSelect" id="2" href="#">2</a></li>
		  <li><a class="chSelect" id="3" href="#">3</a></li>
		  <li><a class="chSelect" id="4" href="#">4</a></li>
		  <li><a class="chSelect" id="5" href="#">5</a></li>
		  <li><a class="chSelect" id="6" href="#">6</a></li>
		  <li><a class="chSelect" id="7" href="#">7</a></li>
		  <li><a class="chSelect" id="8" href="#">8</a></li>
		  <li><a class="chSelect" id="9" href="#">9</a></li>
		  <li><a class="chSelect" id="10" href="#">10</a></li>
		  <li><a class="chSelect" id="11" href="#">11</a></li>
		  <li><a class="chSelect" id="12" href="#">12</a></li>
		  <li><a class="chSelect" id="13" href="#">13</a></li>
		  <li><a class="chSelect" id="14" href="#">14</a></li>
		  <li><a class="chSelect" id="15" href="#">15</a></li>
		  <li><a class="chSelect" id="16" href="#">16</a></li>
		  <li><a class="chSelect" id="17" href="#">17</a></li>
		  <li><a class="chSelect" id="18" href="#">18</a></li>
		  <li><a class="allSelect" id="All" href="#">All</a></li>
        </ol>
		</div>
		<div class="col-lg-3 col-md-12 col-sm-12  d-flex">
			<h4 class="exportBtn">  
			<button type="button" id="exportDocx" class="exportDocx btn btn-primary">Export File <i class="fas fa-file-download"></i></button>
			<!-- <a class="exportDocx" id="exportDocx" href="#">Export File</a> --></h4>
		</div>
		</div>
      </div>
    </section><!-- End Breadcrumbs -->

	    <!-- ======= Chapter Num Section  ======= -->
    <!-- <section id="chapterNum" class="chapterNum">
      <div class="container">
	  <ol>
          <li><a href="index.html">1</a></li>
          <li>2</li>
		  <li>3</li>
		  <li>4</li>
		  <li>5</li>
		  <li>6</li>
		  <li>7</li>
		  <li>8</li>
		  <li>9</li>
		  <li>10</li>
		  <li>11</li>
		  <li>12</li>
		  <li>13</li>
		  <li>14</li>
		  <li>15</li>
		  <li>16</li>
		  <li>17</li>
		  <li>18</li>
        </ol>
        

      </div>
    </section> --> <!-- End Breadcrumbs -->
	
	
	 <!-- ======= Bhagvad Gita Section ======= -->
	<section id="portfolio-details" class="portfolio-details">
      <div class="container">

        <div id="gita-container" class="portfolio-details-container ">
		
		
		

		
		
		
		
		
		</div>

      </div>
    </section>
	
    <!-- ======= Portfolio Details Section ======= -->
    <!-- <section id="portfolio-details" class="portfolio-details">
      <div class="container">

        <div class="portfolio-details-container">

          <div class="owl-carousel portfolio-details-carousel">
            <img src="assets/img/portfolio/portfolio-details-1.jpg" class="img-fluid" alt="">
            <img src="assets/img/portfolio/portfolio-details-2.jpg" class="img-fluid" alt="">
            <img src="assets/img/portfolio/portfolio-details-3.jpg" class="img-fluid" alt="">
          </div>

          <div class="portfolio-info">
            <h3>Project information</h3>
            <ul>
              <li><strong>Category</strong>: Web design</li>
              <li><strong>Client</strong>: ASU Company</li>
              <li><strong>Project date</strong>: 01 March, 2020</li>
              <li><strong>Project URL</strong>: <a href="#">www.example.com</a></li>
            </ul>
          </div>

        </div>

        <div class="portfolio-description">
          <h2>This is an example of portfolio detail</h2>
          <p>
            Autem ipsum nam porro corporis rerum. Quis eos dolorem eos itaque inventore commodi labore quia quia. Exercitationem repudiandae officiis neque suscipit non officia eaque itaque enim. Voluptatem officia accusantium nesciunt est omnis tempora consectetur dignissimos. Sequi nulla at esse enim cum deserunt eius.
          </p>
        </div>

      </div>
    </section> --><!-- End Portfolio Details Section -->

	


<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog " role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Export Shlokas in doc</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="shlokaList" class="col-form-label">Shloka List:</label>
            <textarea class="form-control" id="shlokaList" placeholder="Example 1.10-15,2.5,3.19-21"></textarea>
			
			<!-- <label for="shlokaListHelp" class="col-form-label">Help</label> -->
            <p class="" id="shlokaListHelp" >
			<b>How to specify shloka List</b> <br>
			<ol>
			<li>
			<b>* </b> <br>
			Use * to export all chapters and all shlokas </li>
			<li>
			Use Command seprated list for specific shlokas from chapter <br>
			<ul>
			<li>
			<b>1.10-15,2.5,7.12-15</b> <br>
			This list is to export Ch 1 Sh 10 to 15, Ch 2 Sh 5 and Ch 7 Sh 12 to 15 <br>
			</li>
			<!-- <li>
			<b>1.*,2.10-20 </b><br>
			This list is to export all shloka of Ch 1, Ch 2 Sh 10 to 20 <br>
			</li> -->
			</ul>
			</ol>
			</p>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" id="creatDocBtn" class="btn btn-primary">Create Doc</button>
      </div>
    </div>
  </div>
</div>	
	
	
	
  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">

    <!-- <div class="footer-newsletter">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-6">
            <h4>Join Our Newsletter</h4>
            <p>Tamen quem nulla quae legam multos aute sint culpa legam noster magna</p>
            <form action="" method="post">
              <input type="email" name="email"><input type="submit" value="Subscribe">
            </form>
          </div>
        </div>
      </div>
    </div> -->

    <div class="footer-top">
      <div class="container">
        <div class="row">

          <div class="col-lg-3 col-md-6 footer-contact">
            <h3>Gita Parivar</h3>
            <p>
             <!-- A108 Adam Street <br>
              New York, NY 535022<br>
              United States <br><br>
              <strong>Phone:</strong> +1 5589 55488 55<br> -->
              <strong>Email:</strong> admin@hbajaj.com<br>
            </p>
          </div>

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Home</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">About us</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Services</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Terms of service</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Privacy policy</a></li>
            </ul>
          </div>

          <!-- <div class="col-lg-3 col-md-6 footer-links">
            <h4>Our Services</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Web Design</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Web Development</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Product Management</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Marketing</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Graphic Design</a></li>
            </ul>
          </div> -->

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Our Social Networks</h4>
            <p>Cras fermentum odio eu feugiat lide par naso tierra videa magna derita valies</p>
            <div class="social-links mt-3">
              <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
              <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
              <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
              <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
              <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="container footer-bottom clearfix">
      <div class="copyright">
        &copy; Copyright <strong><span>Hbajaj.com</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/arsha-free-bootstrap-html-template-corporate/ -->
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top"><i class="ri-arrow-up-line"></i></a>
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
 
  <script type="text/javascript">

        // Wait for the page to load first
        // window.onload = function() {


        //  var a = document.getElementById("ch2");

          //Set code to run when the link is clicked
          // by assigning a function to "onclick"
        //  a.onclick = function() {
		//	var chapter = document.getElementById("chapter_2");
		//	chapter.classList.add("visible");
            // Your code here...

            //If you don't want the link to actually 
            // redirect the browser to another page,
            // "google.com" in our example here, then
            // return false at the end of this block.
            // Note that this also prevents event bubbling,
            // which is probably what we want here, but won't 
            // always be the case.
         //   return false;
         // }
        //}

	/*
	Possible shList options 
	1. *  //to export complete 18 chapters 
	2. 1.5 
	3. 1.10-15
	4. 1.*
	
	*/

		var shCount = [0,47,72,43,42,29,47,30,28,34,42,44,20,34,27,20,24,28,78]
		
		function checkShlokaRange(ch,sh) {
			var maxSh = shCount[ch]
			if((sh >0) && (sh <= maxSh)) {
				return true;
			}else {
				return false;
			}	
			return false;
		}
		function validateShlokaList(txt) {
			var result = true;
			log.debug("validateShlokaList: " + txt);
			var shList = txt.split(",");
			log.debug("shList: " + shList.length);			
			//No input from user then validation fails
			if ((shList.length == 1) && (shList[0] == "")) {
				log.error("No value entered");
				result = false;
			}else if ((shList.length == 1) /*&& (shList[0].search('.') == -1)*/ && (shList[0] == "*")) {
				//If only 1 option then check if its *
				log.debug("shList has only *");
					result = true;
			}else {
				for(i=0;i<shList.length;i++) {
					var entry = shList[i];
					var chNum = entry.split('.');
					if(chNum[1].search('-') != -1) {
						var shNum = chNum[1].split('-');
						if ( (!Number.isInteger(parseInt(shNum[0])) ) ||  (!Number.isInteger(parseInt(shNum[1])) )) {
						log.error("Shloka number should be integer values");
							result = false;
						}else {
							//Check if shloka number is within number of shlokas in chapter 
							if( checkShlokaRange(chNum[0],shNum[0]) && checkShlokaRange(chNum[0],shNum[1]) ) {
								result = true;
							}else {
								log.error("Shloka number out of range:" + chNum[0] + "." + shNum[0] + "-" + shNum[1]);
								result = false;
							}
						}		
					}else if( !((Number.isInteger(parseInt(chNum[1])) ))) {
						log.error("After . it should be either * or integer: " + chNum[1]);
						result = false;
					}else {
						if( checkShlokaRange(chNum[0],chNum[1])) {
								result = true;
							}else {
								log.error("Shloka number out of range:" + chNum[0] + "." + chNum[1] );
								result = false;
							}
					}
					if(result == false) {
						break;
					}
				}
			}	
			return result;
		}
		function handleShlokaList(txt) {
			//var shList = ['1.10-15','2.5','3.6-8','3.15-20']
			var result = true;
			var finalList = new Array ();
			result = validateShlokaList(txt);
			log.debug("Validation result:" + result);
			if (result == true) {
				var shList = txt.split(",");
				var i;
				if ((shList.length == 1) && (shList[0] == "*")) {
					log.debug("Handling *");
					var ch,sh,k;
					for(i=1;i<=shCount.length  ;i++) {
						ch = i;
						log.debug("Chapter number :" + i);
						for(k=1;k<= shCount[i];k++) {
							var chSh = "#shloka_" + i + "_"  + k;
							finalList.push(chSh)
						}
						log.debug("Last Shloka number :" + k);
					
					}
				}else {
					for(i=0;i<shList.length;i++) {
						var entry = shList[i];
						var chNum = entry.split('.');
						if(chNum[1].search('-') != -1) {
							var shNum = chNum[1].split('-');
							var j =0;
							for(j=shNum[0];j<=shNum[1];j++) {
								var chSh = "#shloka_" + chNum[0] + "_"  + j;
								finalList.push(chSh)
							}
						}else {
							var chSh = "#shloka_" + chNum[0] + "_"  + chNum[1];
							finalList.push(chSh)
						}
						
					}
				}
			}else {
				log.error("Validation of input for export failed");
			}
			return [result,finalList];
		}
		$(document).ready(function(){
			log.setLevel("debug")
			$("#gita-container").load("gitaComplete.html");
			
			$(".exportDocx").on("click", function(e) {
				$('#exampleModal').modal('show');
			});
			
			$("#creatDocBtn").on("click", function(e) {
				var txt = $("#shlokaList").val()
				log.debug(txt)
				$("#shlokaList").val("")
				$('#exampleModal').modal('hide');
				log.debug("Enter exportDocx handler");
				const [result, shList] = handleShlokaList(txt);
				if(result == true) {
					log.debug(shList);
					var i = 0;
					const doc = new docx.Document();
					log.debug("shList len:" + shList.length);
					var shSplitArr = new Array()

					for (i=0;i<shList.length;i++) {
						var meaningNum = shList[i].replace(/shloka/,"meaning");
						log.debug("meaningNum :" + meaningNum);
						var shTxt = $(shList[i]).text().trim()
						var meaningTxt = $(meaningNum).text().trim()
						var shSplit = shTxt.split("\n");
						log.debug(shTxt);
						log.debug("shSplit len:" + shSplit.length);
						var j =0;
						for (j = 0 ; j < shSplit.length;j++) {
							var txt = new docx.Paragraph({
									alignment: docx.AlignmentType.CENTER,					
									children: [
									new docx.TextRun({
										text: shSplit[j],
										bold: true,
										break:true,
										size: 36, //Size is in halfPts so if size 18 is required here 36 needs to be specified
										font: "Calibri",
										})
										],
										});
							shSplitArr.push(txt);
						
						}
											
						var meaningPara = new docx.Paragraph({
									alignment: docx.AlignmentType.LEFT,
									children: [
										new docx.TextRun({
										text: meaningTxt,
										break: true,
										size: 32,
										}),		
									],
									spacing: {
										
										after: 200,
									},
								});
						shSplitArr.push(meaningPara)
					}
					doc.addSection({
							properties: {},
							children: shSplitArr,
						});
					
					//Save document as docx file
					docx.Packer.toBlob(doc).then(blob => {
							//log.debug(blob);
							saveAs(blob, "gitaShloka.docx");
							log.debug("Document created successfully");
					});
				}
			});
			
			
			
			//Handler to change the chapter based on selection done by user			
			$(".chSelect").on("click", function(e) {
				
				// Use `this` here
				e.preventDefault();
				var chNum = $(this).attr('id')
				//log.debug("Btn clicked:" + chNum)
				var i;
				for (i = 1; i < 19; i++) {
				  var chSelector = "chapter_" + i
				  //var elem = $('#'+chSelector)
				  log.debug(chSelector);
				  var elem = document.getElementById(chSelector);
				  if(i == chNum) {
					log.debug("selected ch addClass");
					elem.classList.add("visible");
				  }else {
					elem.classList.remove("visible");
					elem.classList.add("hidden");
				  }
				}
				
			});
			//To display all chapters when user selects All
			$(".allSelect").on("click", function(e) {
				e.preventDefault();
				for (i = 1; i < 19; i++) {
				  var chSelector = "chapter_" + i
				  //var elem = $('#'+chSelector)
				  log.debug(chSelector);
				  var elem = document.getElementById(chSelector);
				  
					elem.classList.remove("hidden");
					elem.classList.add("visible");
				  
				}
			});
		});
    </script>
  

</body>

</html>